Resources:

  ConfigRule1:
    Type: 'AWS::Config::ConfigRule'
    Properties:
      ConfigRuleName: "AWS-01-root-mfa-check"
      Description: "AWS 계정 루트 사용자에 대해 다중 인증(MFA)이 활성화되어 있는지 확인합니다."
      Source:
        Owner: "AWS"
        SourceIdentifier: "ROOT_ACCOUNT_MFA_ENABLED"
      Scope:
        ComplianceResourceTypes:
          - "AWS::IAM::User"

  ConfigRule2:
    Type: 'AWS::Config::ConfigRule'
    Properties:
      ConfigRuleName: "AWS-04-iam-user-access-key-check"
      Description: "IAM 사용자의 액세스 키가 지정된 일 수(기본값 90일) 내에 교체되었는지 확인합니다."
      Source:
        Owner: "AWS"
        SourceIdentifier: "IAM_USER_ACCESS_KEY_ROTATED"
      Scope:
        ComplianceResourceTypes:
          - "AWS::IAM::User"

  ConfigRule3:
    Type: 'AWS::Config::ConfigRule'
    Properties:
      ConfigRuleName: "AWS-05-iam-password-policy-check"
      Description: "IAM 사용자에 대한 계정 암호 정책이 지정된 요구 사항을 충족하는지 확인합니다."
      Source:
        Owner: "AWS"
        SourceIdentifier: "IAM_PASSWORD_POLICY"
      Scope:
        ComplianceResourceTypes:
          - "AWS::IAM::User"

  ConfigRule4:
    Type: 'AWS::Config::ConfigRule'
    Properties:
      ConfigRuleName: "AWS-29-s3-bucket-public-access-prohibited"
      Description: "S3 버킷이 공개 읽기/쓰기 액세스를 허용하지 않는지 확인합니다."
      Source:
        Owner: "AWS"
        SourceIdentifier: "S3_BUCKET_PUBLIC_READ_PROHIBITED"
      Scope:
        ComplianceResourceTypes:
          - "AWS::S3::Bucket"

  ConfigRule5:
    Type: 'AWS::Config::ConfigRule'
    Properties:
      ConfigRuleName: "AWS-30-s3-bucket-logging-enabled"
      Description: "S3 버킷에 로깅이 활성화되어 있는지 확인합니다."
      Source:
        Owner: "AWS"
        SourceIdentifier: "S3_BUCKET_LOGGING_ENABLED"
      Scope:
        ComplianceResourceTypes:
          - "AWS::S3::Bucket"

  ConfigRule6:
    Type: 'AWS::Config::ConfigRule'
    Properties:
      ConfigRuleName: "AWS-32-encrypted-volumes"
      Description: "EC2 인스턴스에 연결된 EBS 볼륨이 암호화되어 있는지 확인합니다."
      Source:
        Owner: "AWS"
        SourceIdentifier: "ENCRYPTED_VOLUMES"
      Scope:
        ComplianceResourceTypes:
          - "AWS::EC2::Volume"

  ConfigRule7:
    Type: 'AWS::Config::ConfigRule'
    Properties:
      ConfigRuleName: "AWS-33-rds-storage-encrypted"
      Description: "RDS DB 인스턴스에 대해 스토리지 암호화가 활성화되어 있는지 확인합니다."
      Source:
        Owner: "AWS"
        SourceIdentifier: "RDS_STORAGE_ENCRYPTED"
      Scope:
        ComplianceResourceTypes:
          - "AWS::RDS::DBInstance"

  ConfigRule8:
    Type: 'AWS::Config::ConfigRule'
    Properties:
      ConfigRuleName: "AWS-34-rds-snapshots-public-prohibited"
      Description: "RDS 스냅샷이 공개되어 있는지 확인합니다."
      Source:
        Owner: "AWS"
        SourceIdentifier: "RDS_SNAPSHOTS_PUBLIC_PROHIBITED"
      Scope:
        ComplianceResourceTypes:
          - "AWS::RDS::DBSnapshot"

  ConfigRule9:
    Type: 'AWS::Config::ConfigRule'
    Properties:
      ConfigRuleName: "AWS-35-rds-instance-public-access-check"
      Description: "RDS DB 인스턴스가 공개적으로 액세스 가능한지 확인합니다."
      Source:
        Owner: "AWS"
        SourceIdentifier: "RDS_INSTANCE_PUBLIC_ACCESS_CHECK"
      Scope:
        ComplianceResourceTypes:
          - "AWS::RDS::DBInstance"
